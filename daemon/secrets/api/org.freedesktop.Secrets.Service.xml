<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">

<!-- 
 * This is the well known dbus service name for controlling the 
 * entire daemon. The services manages collections of secrets. These
 * are analogous to the gnome-keyring 'keyrings'.
-->

<node name="/org/freedesktop/Secrets">

	<interface name="org.freedesktop.Secrets.Service">

		<method name="OpenSession">
			<annotation value="Open a unique session for the caller application." name="org.gtk.EggDBus.DocString"/>
			              
			<arg name="result" type="o" direction="out">
				<annotation value="The object path of the session." name="org.gtk.EggDBus.DocString"/>
			</arg>
		</method>
		
		<method name="ListCollections">
			<annotation value="List the object paths of all collections (ie: keyrings)" name="org.gtk.EggDBus.DocString"/>
			            
			<arg name="result" type="ao" direction="out">
				<annotation value="An array of object paths of collections" name="org.gtk.EggDBus.DocString"/>
			</arg>
		</method>

		<method name="CreateCollection">
			<annotation value="Create a new collection with the specified access attributes" name="org.gtk.EggDBus.DocString"/>
			            
			<arg name="display_name" type="s" direction="in">
				<annotation value="The display name of the new collection" name="org.gtk.EggDBus.DocString"/>
			</arg>
			
			<!-- TODO: Access rules need more thought. Unimplemented -->
			<arg name="access_rules" type="as" direction="in">
				<annotation value="The access rules of the new collection" name="org.gtk.EggDBus.DocString"/>
			</arg>
		</method>

		<property name="DefaultCollection" type="o" access="readwrite">
			<annotation value="The object path of the default collection." name="org.gtk.EggDBus.DocString"/>
		</property>
		
		<method name="LockService">
			<annotation value="Lock down the entire service. Remove secrets from memory, lock all collections etc..." name="org.gtk.EggDBus.DocString"/>
		</method>

		<method name="SearchCollections">
			<annotation value="Find items in any collection." name="org.gtk.EggDBus.DocString"/>
			            
			<arg name="fields" type="a{ss}" direction="in">
				<annotation value="Find secrets in any collection." name="org.gtk.EggDBus.DocString"/>
			</arg>
			
			<arg name="results" type="ao" direction="out">
				<annotation value="Items found." name="org.gtk.EggDBus.DocString"/>
			</arg>

			<arg name="locked" type="ao" direction="out">
				<annotation value="Items found that require authentication." name="org.gtk.EggDBus.DocString"/>
			</arg>
		</method>
		
		<method name="RetrieveSecrets">
			<annotation value="Retrieve multiple secrets from different items." name="org.gtk.EggDBus.DocString"/>
			            
			<arg name="items" type="ao" direction="in">
				<annotation value="Items to get secrets for." name="org.gtk.EggDBus.DocString"/>
			</arg>
			
			<arg name="secrets" type="a(sayay)" direction="out">
				<annotation value="Secrets for the items, in order." name="org.gtk.EggDBus.DocString"/>
				<annotation value="Array<Secret>" name="org.gtk.EggDBus.Type"/>
			</arg>
		</method>
		
		<signal name="CollectionCreated">
			<annotation value="A collection was created." name="org.gtk.EggDBus.DocString"/>
			
			<arg name="collection" type="o">
				<annotation value="Collection that was created" name="org.gtk.EggDBus.DocString"/>
			</arg>
		</signal>
		
		<signal name="CollectionDeleted">
			<annotation value="A collection was deleted." name="org.gtk.EggDBus.DocString"/>

			<arg name="collection" type="o">
				<annotation value="Collection that was created" name="org.gtk.EggDBus.DocString"/>
			</arg>
		</signal>

	</interface>
</node>

