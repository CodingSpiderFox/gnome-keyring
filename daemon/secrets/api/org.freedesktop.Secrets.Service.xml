<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">

<!-- 
 * This is the well known dbus service name for controlling the 
 * entire daemon. The services manages collections of secrets. These
 * are analogous to the gnome-keyring 'keyrings'.
-->

<node name="/org/freedesktop/secrets">
	<interface name="org.freedesktop.Secrets.Service">

		<method name="CreateSession">
			<annotation name="org.gtk.EggDBus.DocString" 
			            value="Create a unique session for the caller application."/>
			              
			<arg name="result" type="o" direction="out">
				<annotation name="org.gtk.EggDBus.DocString"
				            value="The object path of the session."/>
			</arg>
		</method>
		
		<method name="ListCollections">
			<annotation name="org.gtk.EggDBus.DocString"
			            value="List the object paths of all collections (ie: keyrings)"/>
			            
			<arg name="result" type="ao" direction="out">
				<annotation name="org.gtk.EggDBus.DocString"
				            value="An array of object paths"/>
			</arg>
		</method>

		<method name="CreateCollection">
			<annotation name="org.gtk.EggDBus.DocString"
			            value="Create a new collection with the specified access attributes"/>
			            
			<arg name="display_name" type="s" direction="in">
				<annotation name="org.gtk.EggDBus.DocString"
				            value="The display name of the new collection"/>
			</arg>
			
			<!-- TODO: Access rules need more thought. Unimplemented -->
			<arg name="access_rules" type="as" direction="in">
				<annotation name="org.gtk.EggDBus.DocString"
				            value="The access rules of the new collection"/>
			</arg>
		</method>

		<property name="DefaultCollection" type="o" access="readwrite">
			<annotation name="org.gtk.EggDBus.DocString"
			            value="The object path of the default collection."/>
		</property>
		
		<method name="LockService">
			<annotation name="org.gtk.EggDBus.DocString"
			            value="Lock down the entire service. Remove secrets from memory, lock all collections etc..."/>
		</method>

		<method name="FindSecrets">
			<annotation name="org.gtk.EggDBus.DocString"
			            value="Find secrets in any collection."/>
			            
			<arg name="fields" type="a{ss}" direction="in">
			</arg>
			
			<arg name="results" type="a{os}" direction="out">
			</arg>
		</method>
		
		<signal name="CollectionCreated">
			<arg name="collection" type="o"/>
		</signal>
		
		<signal name="CollectionDeleted">
			<arg name="collection" type="o"/>
		</signal>

	</interface>
</node>

